config: {}
cluster: null
networks: []
storage_pools:
- config: 
    source: /var/snap/lxd/common/lxd/storage-pools/default
  description: ""
  name: default
  driver: btrfs
- config: 
    source: /var/snap/lxd/common/lxd/storage-pools/docker
  description: docker-storage
  name: docker
  driver: btrfs
- config: 
    source: /var/snap/lxd/common/lxd/storage-pools/kubernetes
  description: kubernetes-storage
  name: kubernetes
  driver: btrfs
profiles:
- name: default
  config: {}
  description: ""
  devices:
    eth0:
      nictype: bridged
      name: eth0
      parent: ovs0
      type: nic
    root:
      path: /
      pool: default
      type: disk
- name: docker
  config:
    # the security settings are needed for docker
    security.nesting: true 
    security.syscalls.intercept.mknod: true 
    security.syscalls.intercept.setxattr: true
    # security.privileged: true # maybe needed

    raw.lxc: |
      lxc.apparmor.profile=unconfined
      lxc.cap.drop= 
      lxc.cgroup.devices.allow=a
      lxc.mount.auto=proc:rw sys:rw
      lxc.mount.entry = /dev/kmsg dev/kmsg none defaults,bind,create=file

    linux.kernel_modules: bridge,ip_tables,ip6_tables,iptable_nat,iptable_mangle,netlink_diag,nf_nat,overlay,br_netfilter,bonding,ip_vs,ip_vs_dh,ip_vs_ftp,ip_vs_lblc,ip_vs_lblcr,ip_vs_lc,ip_vs_nq,ip_vs_rr,ip_vs_sed,ip_vs_sh,ip_vs_wlc,ip_vs_wrr,xfrm_user,xt_conntrack,xt_MASQUERADE
    # limit the memory and cpu resources
    limits.memory: 15GB # 4 machines per host with 15GB 
    limits.memory.swap: false
    limits.cpu: 2       # max 2 CPU cores.
  description: ""
  devices:
    eth0:
      nictype: bridged
      name: eth0
      parent: ovs0
      type: nic
    root:
      path: /
      pool: docker
      type: disk
- name: kubernetes
  config:
    # the security settings are needed for docker
    security.nesting: true 
    security.syscalls.intercept.mknod: true 
    security.syscalls.intercept.setxattr: true
    security.privileged: true # maybe needed

    linux.kernel_modules: bridge,ip_tables,ip6_tables,iptable_nat,iptable_mangle,netlink_diag,nf_nat,overlay,br_netfilter,bonding,ip_vs,ip_vs_dh,ip_vs_ftp,ip_vs_lblc,ip_vs_lblcr,ip_vs_lc,ip_vs_nq,ip_vs_rr,ip_vs_sed,ip_vs_sh,ip_vs_wlc,ip_vs_wrr,xfrm_user,xt_conntrack,xt_MASQUERADE
    # limit the memory and cpu resources
    limits.memory: 15GB # 4 machines per host with 15GB 
    limits.memory.swap: false
    limits.cpu: 2       # max 2 CPU cores.
  description: ""
  devices:
    eth0:
      nictype: bridged
      name: eth0
      parent: ovs0
      type: nic
    root:
      path: /
      pool: kubernetes
      type: disk